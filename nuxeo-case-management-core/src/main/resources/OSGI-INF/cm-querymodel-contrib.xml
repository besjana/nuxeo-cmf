<?xml version="1.0"?>

<component name="com.nuxeo.correspondence.querymodel">

  <extension
    target="org.nuxeo.ecm.core.search.api.client.querymodel.QueryModelService"
    point="model">

    <queryModel name="CASE_FOLDER_INBOX">
      <pattern>
        SELECT * FROM Document WHERE ecm:parentId = ? AND ecm:isCheckedInVersion
        = 0 AND ecm:mixinType != 'HiddenInNavigation' AND
        ecm:currentLifeCycleState != 'deleted' AND ecm:mixinType = 
        'CaseLink' AND cslk:isSent = 0 AND cslk:draft = 0
      </pattern>
      <sortable value="true" defaultSortColumn="cslk:date"
        defaultSortAscending="false" />
      <max>10</max>
    </queryModel>
    
    <queryModel name="CASE_FOLDER_SERVICE">
      <pattern>
        SELECT * FROM Document WHERE ecm:parentId = ? AND ecm:isCheckedInVersion
        = 0 AND ecm:mixinType != 'HiddenInNavigation' AND
        ecm:currentLifeCycleState != 'deleted' AND ecm:mixinType = 'CaseLink'
        AND cslk:draft = 0
      </pattern>
      <sortable value="true" defaultSortColumn="dc:title"
        defaultSortAscending="true" />
      <max>10</max>
    </queryModel>
    
    <queryModel name="CASE_FOLDER_SENT">
      <pattern>
        SELECT * FROM Document WHERE ecm:parentId = ? AND ecm:isCheckedInVersion
        = 0 AND ecm:mixinType != 'HiddenInNavigation' AND
        ecm:currentLifeCycleState != 'deleted' AND ecm:mixinType = 'CaseLink'
         AND cslk:isSent = 1 AND cslk:draft = 0
      </pattern>
      <sortable value="true" defaultSortColumn="dc:title"
        defaultSortAscending="true" />
      <max>10</max>
    </queryModel>
    
    <queryModel name="CASE_FOLDER_DRAFT">
      <pattern>
        SELECT * FROM Document WHERE ecm:parentId = ? AND ecm:isCheckedInVersion
        = 0 AND ecm:mixinType != 'HiddenInNavigation' AND
        ecm:currentLifeCycleState != 'deleted' AND ecm:mixinType = 'CaseLink'
        AND cslk:draft = 1
      </pattern>
      <sortable value="true" defaultSortColumn="dc:title"
        defaultSortAscending="true" />
      <max>10</max>
    </queryModel>

    <queryModel name="CASE_FOLDER_PLANS">
      <pattern>
        SELECT * FROM ClassificationRoot WHERE ecm:parentId = ? AND ecm:isCheckedInVersion
        = 0 AND ecm:mixinType != 'HiddenInNavigation' AND
        ecm:currentLifeCycleState != 'deleted'
      </pattern>
      <sortable value="true" defaultSortColumn="dc:title"
        defaultSortAscending="true" />
      <max>10</max>
    </queryModel>

    <!-- Case Management Default Service -->

    <queryModel name="GET_CASE_FOLDER_FROM_ID">
      <pattern>
        SELECT * FROM Document WHERE csfd:case_folder_id=? 
        AND ecm:currentLifeCycleState != 'deleted' 
        AND ecm:mixinType = 'Mailbox'
      </pattern>
    </queryModel>

    <queryModel name="GET_ALL_CASE_FOLDER">
      <pattern>
        SELECT * FROM Document WHERE ecm:currentLifeCycleState != 'deleted' 
        AND ecm:mixinType = 'Mailbox'
      </pattern>
    </queryModel>

  </extension>

</component>
